# ğŸ” AI-Generated Image Detection System

A deep learning-powered web application that distinguishes between AI-generated and human-created images with 99.3% accuracy using ResNet50 architecture.

![Python](https://img.shields.io/badge/python-3.8+-blue.svg)
![TensorFlow](https://img.shields.io/badge/TensorFlow-2.x-orange.svg)
![FastAPI](https://img.shields.io/badge/FastAPI-0.100+-green.svg)
![License](https://img.shields.io/badge/license-MIT-blue.svg)

## ğŸ“‹ Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Model Architecture](#model-architecture)
- [Performance Metrics](#performance-metrics)
- [Installation](#installation)
- [Usage](#usage)
- [API Documentation](#api-documentation)
- [Project Structure](#project-structure)
- [Dataset](#dataset)
- [Training Details](#training-details)
- [Contributing](#contributing)
- [License](#license)

## ğŸ¯ Overview

This project implements a sophisticated binary classifier that can determine whether an image was generated by AI or created by humans. Built with transfer learning using ResNet50 as the base model, the system achieves exceptional accuracy on a balanced dataset of 79,950 images.

### Key Highlights

- **99.3% Validation Accuracy** on 15,990 test images
- **Real-time prediction** through a FastAPI backend
- **Transfer Learning** with ResNet50 pre-trained on ImageNet
- **Balanced Dataset** with 50/50 split between AI and real images
- **Production-ready** with proper error handling and validation

## âœ¨ Features

- **High Accuracy Detection**: 99% precision and recall for both classes
- **Fast Inference**: Optimized model for quick predictions
- **RESTful API**: Easy integration with web and mobile applications
- **Image Preprocessing**: Automatic resizing and normalization
- **Robust Error Handling**: Comprehensive validation and error messages
- **Multi-format Support**: Handles JPEG, JPG, and PNG images

## ğŸ—ï¸ Model Architecture

The model uses a pre-trained ResNet50 backbone with custom classification layers:

```
Input Layer (224x224x3)
    â†“
ResNet50 Preprocessing
    â†“
ResNet50 Base (ImageNet weights, frozen)
    â†“
Global Average Pooling 2D
    â†“
Flatten
    â†“
Dense(150, activation='relu') + L2 Regularization (0.01)
    â†“
Dropout(0.5)
    â†“
Dense(1, activation='sigmoid')
```

### Technical Specifications

- **Input Shape**: 224 x 224 x 3 (RGB images)
- **Base Model**: ResNet50 (pre-trained on ImageNet)
- **Optimizer**: Adam
- **Loss Function**: Binary Crossentropy
- **Regularization**: L2 (0.01) + Dropout (0.5)
- **Metrics**: Accuracy, AUC

## ğŸ“Š Performance Metrics

### Training Results

| Epoch | Train Acc | Val Acc | Train Loss | Val Loss | AUC    |
|-------|-----------|---------|------------|----------|--------|
| 1     | 90.61%    | 64.53%  | 0.6598     | 1.9060   | 0.9593 |
| 7     | 99.04%    | 99.19%  | 0.0358     | 0.0295   | 0.9992 |
| 14    | 99.52%    | **99.34%** | 0.0190  | 0.0238   | 0.9997 |

### Final Classification Report

```
              precision    recall    f1-score    support

Real              0.99      1.00      0.99       7995
AI                1.00      0.99      0.99       7995

accuracy                              0.99      15990
macro avg         0.99      0.99      0.99      15990
weighted avg      0.99      0.99      0.99      15990
```

## ğŸš€ Installation

### Prerequisites

- Python 3.8 or higher
- pip package manager
- 4GB+ RAM recommended

### Step 1: Clone the Repository

```bash
git clone https://github.com/Nilanjan899/AI-Image-Generated-Detector
cd AI-Image-Generated-Detector
```

### Step 2: Create Virtual Environment

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### Step 3: Install Dependencies

```bash
pip install -r requirements.txt
```

### Step 4: Download Model

Place the trained model file in the `model/` directory:
- `serious_res_net_50_224x224_95_acc_ai_or_real_keras_file.keras`

## ğŸ’» Usage

### Starting the Server

```bash
python main.py
```

The server will start at `http://localhost:8000`

### Web Interface

1. Open your browser and navigate to `http://localhost:8000`
2. Upload an image (JPEG, JPG, or PNG)
3. Click "Analyze"
4. View the AI generation probability

### Command Line Testing

```python
import requests

url = "http://localhost:8000/predict"
files = {"file": open("test_image.jpg", "rb")}
response = requests.post(url, files=files)
print(response.json())
```

## ğŸ“¡ API Documentation

### Endpoints

#### GET `/`
Returns the main web interface.

**Response**: HTML page

#### POST `/predict`
Analyzes an uploaded image and returns AI generation probability.

**Request**:
- Content-Type: `multipart/form-data`
- Body: Image file (JPEG/JPG/PNG)

**Response**:
```json
{
  "success": true,
  "ai_probability": 85.42,
  "filename": "example.jpg"
}
```

**Error Response**:
```json
{
  "error": "Error message describing the issue"
}
```

### Status Codes

- `200`: Successful prediction
- `400`: Invalid file type or format
- `500`: Server error during processing

## ğŸ“ Project Structure

```
ai-image-detector/
â”‚
â”œâ”€â”€ main.py                     # FastAPI backend server
â”œâ”€â”€ requirements.txt            # Python dependencies
â”œâ”€â”€ README.md                   # Project documentation
â”‚
â”œâ”€â”€ model/
â”‚   â””â”€â”€ serious_res_net_50_224x224_95_acc_ai_or_real_keras_file.keras
â”‚
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html             # Web interface
â”‚
|
â”‚
â””â”€â”€ model_generation/
    â””â”€â”€ model_generator.ipynb   # Model development notebook
```

## ğŸ“¦ Dataset
This model is trained on the [AI vs. Human-Generated Images](https://www.kaggle.com/datasets/marquis03/ai-vs-human-generated-dataset) dataset from Kaggle (79,950 images, balanced split).
### Statistics

- **Total Images**: 79,950
- **Training Set**: 63,960 images (80%)
- **Validation Set**: 15,990 images (20%)
- **Class Distribution**: 
  - Real Images: 39,975 (50%)
  - AI-Generated: 39,975 (50%)
- **Format**: JPEG
- **Resolution**: Variable (resized to 224x224 for training)

### Data Split

The dataset was split using stratified sampling to maintain class balance:
- `train_test_split` with 80/20 ratio
- `stratify=df["label"]` ensures balanced classes
- `random_state=42` for reproducibility

## ğŸ“ Training Details

### Data Pipeline

```python
# TensorFlow Data Pipeline
- Parallel image loading (AUTOTUNE)
- On-the-fly JPEG decoding
- Resizing to 224x224
- ResNet50 preprocessing
- Batch size: 32
- Prefetching for performance
```

### Training Configuration

```python
Optimizer: Adam
Learning Rate: 0.001
Epochs: 15 (Early stopping at epoch 14)
Batch Size: 32
Loss Function: Binary Crossentropy
Callbacks:
  - EarlyStopping (patience=5, monitor='val_accuracy')
  - ReduceLROnPlateau (factor=0.5, patience=3)
  - ModelCheckpoint (save_best_only=True)
```

### Hardware

- **GPU**: Tesla P100-PCIE-16GB
- **Memory**: 15,513 MB
- **Training Time**: ~5-6 minutes per epoch
- **Total Training Time**: ~77 minutes

## ğŸ”§ Dependencies

```txt
fastapi>=0.100.0
uvicorn>=0.23.0
tensorflow>=2.13.0
numpy>=1.24.0
pillow>=10.0.0
python-multipart>=0.0.6
jinja2>=3.1.2
```

## ğŸ¤ Contributing

Contributions are welcome! Please follow these steps:

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

### Development Guidelines

- Follow PEP 8 style guidelines
- Add tests for new features
- Update documentation as needed
- Ensure all tests pass before submitting PR

## ğŸ“ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ‘ Acknowledgments

- ResNet50 architecture by Microsoft Research
- TensorFlow and Keras teams
- FastAPI framework
- Kaggle for hosting the dataset and compute resources

## ğŸ“§ Contact

For questions, issues, or suggestions:

- Create an issue in the GitHub repository
- Email: your.email@example.com
- Twitter: @yourusername

## ğŸ”® Future Improvements

- [ ] Add support for batch predictions
- [ ] Implement model versioning
- [ ] Add confidence score visualization
- [ ] Support for more image formats (WebP, TIFF)
- [ ] Mobile app integration
- [ ] Real-time video analysis
- [ ] Model explainability (Grad-CAM visualization)
- [ ] API rate limiting and authentication

---

**Star â­ this repository if you find it helpful!**